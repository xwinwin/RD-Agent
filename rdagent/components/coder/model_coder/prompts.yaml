extract_model_formulation_system: |-
    提供本文中提出的模型的描述，用latex公式以及变量写出模型的公式，还有模型的架构。格式应该像
    {
        "model_name (模型的名称)": {
            "description": "模型的详细描述",
            "formulation": "代表模型公式的LaTeX公式",
            "architecture": "模型架构的详细描述，例如神经网络层或树结构",
            "variables": {
                "\\hat{y}_u": "节点u的预测输出",
                "variable_name_2": "变量2的描述",
                "variable_name_3": "变量3的描述"
            },
            "hyperparameters": {
                "hyperparameter_name_1": "超参数1的值",
                "hyperparameter_name_2": "超参数2的值",
                "hyperparameter_name_3": "超参数3的值"
            },
            "training_hyperparameters" {  # 所有值仅供参考；你可以自己设置
                "n_epochs": "100",
                "lr": "1e-3",
                "early_stop": 10,
                "batch_size": 256,
                "weight_decay": 1e-4,
            }
            "model_type": "表格型或时间序列型或图型或XGBoost"  # 应该是"表格型（Tabular）"、"时间序列型（TimeSeries）"、"图型（Graph）"或"XGBoost"之一
        }
    }
    这样的格式内容应该以```json开始并以```结束，内容应该是json格式。

evolving_strategy_model_coder:
    system: |-
        用户正在尝试在以下场景中实现一些PyTorch模型：
        {{ scenario }}
        你的代码应该以任何形式与场景对齐，这意味着用户需要根据输入数据获得模型的预测。

        为了帮助你写出正确的代码，用户可能会提供多条信息来帮助你写出正确的代码：
        1. 用户可能向你提供类似模型的正确代码。你应该从这些代码中学习，写出正确的代码。
        2. 用户可能向你提供先前失败的代码和相应的代码代码。反馈包含执行、代码和模型输出值。你应该分析反馈并尝试纠正最新的代码。
        3. 用户可能向你提供对最新失败代码的建议和一些类似的失败到正确的对。每个对包含具有类似错误的失败代码和相应的正确版本代码。你应该从这些建议中学习，写出正确的代码。

        你必须根据你下面的先前最新尝试来写代码，这包括你的先前代码和代码反馈，你应该仔细阅读先前的尝试，绝不能修改代码的正确部分。

        {% if current_code is not none %}
        用户之前写了一些代码。你应该基于这段代码写新代码。以下是最新代码：
        ```python
        {{ current_code }}
        ```
        你的代码应该与先前代码非常相似，这意味着你的代码应该与先前代码90%以上相同！你不应该修改代码的正确部分。
        {% else %}
        用户之前没有写任何代码。你应该从头开始写新代码。
        {% endif %}

        {% if queried_former_failed_knowledge|length != 0 %}
        --------------你先前的最新尝试:---------------
        =====先前实现的代码=====
        {{ queried_former_failed_knowledge[-1].implementation.all_codes }}
        =====对先前实现的反馈=====
        {{ queried_former_failed_knowledge[-1].feedback }}
        {% endif %}
        
        请按照以下JSON格式回复代码。以下是JSON输出的示例结构：
        {
            "code": "Python代码作为字符串。"
        }

    user: |-
        --------------目标模型信息:---------------
        {{ model_information_str }}

        {% if queried_similar_successful_knowledge|length != 0 %}
        --------------类似模型的正确代码:---------------
        {% for similar_successful_knowledge in queried_similar_successful_knowledge %}
        =====模型 {{loop.index}}:=====
        {{ similar_successful_knowledge.target_task.get_task_information() }}
        =====代码:=====
        {{ similar_successful_knowledge.implementation.all_codes }}
        {% endfor %}
        {% endif %}

        {% if queried_former_failed_knowledge|length != 0 %}
        --------------先前失败的代码:---------------
        {% for former_failed_knowledge in queried_former_failed_knowledge %}
        =====实现 {{ loop.index }} 的代码=====
        {{ former_failed_knowledge.implementation.all_codes }}
        =====实现 {{ loop.index }} 的反馈=====
        {{ former_failed_knowledge.feedback }}
        {% endfor %}
        {% endif %}

evaluator_code_feedback:
    system: |-
        用户正在尝试在以下场景中实现一些模型：
        {{ scenario }}
        用户将向你提供模型的信息。

        你的工作是检查用户的代码是否与模型信息和场景对齐。
        用户将提供源代码，如果执行失败，还会提供执行错误消息。
        用户可能向你提供真实代码以供你提供评论。你不应该以任何形式向用户泄露真实代码，但你可以使用它来提供评论。

        用户还比较了用户代码和真实代码生成的输出。用户将向你提供一些分析两个输出的结果。你可能会发现代码中的某些错误导致两个输出之间的差异。

        如果提供了真实代码，你的评论应该只考虑检查用户的代码是否与真实代码对齐，因为真实代码肯定是正确的。
        如果没有提供真实代码，你的评论应该考虑检查用户的代码是否合理和正确，以及是否符合描述和场景。

        请注意，你的评论不是让用户调试代码。它们被发送给编码代理以纠正代码。所以不要提供任何让用户检查的项目，如"请检查代码第XXX行"。

        你的建议不应该包含任何代码，只是一些清晰而简短的建议。请在回复中指出非常关键的问题，忽略不重要的以避免混淆。如果代码中没有发现大问题，你可以回复"没有发现评论"。

        你应该为你的每条评论提供建议以帮助用户改进代码。请按照以下格式回复评论。以下是输出的示例结构：
        评论1: 评论1的消息
        评论2: 评论2的消息
    
    user: |-
        --------------模型信息:---------------
        {{ model_information }}
        --------------Python代码:---------------
        {{ code }}
        --------------执行反馈:---------------
        {{ model_execution_feedback }}
        {% if model_value_feedback is not none %}
        --------------模型值反馈:---------------
        {{ model_value_feedback }}
        {% endif %}
        {% if gt_code is not none %}
        --------------真实Python代码:---------------
        {{ gt_code }}
        {% endif %}


evaluator_final_feedback:
    system: |-
        用户正在尝试在以下场景中实现一个模型：
        {{ scenario }}
        用户已完成评估并从评估器获得了一些反馈。
        评估器运行代码并获得输出，并提供了一些关于用户代码和代码输出的反馈。你应该分析反馈并考虑场景和模型描述，以给出关于评估结果的最终决定。最终决定总结模型是否被正确实现，以及如果最终决定为False，是否包含详细反馈和原因。

        最终决定的实现逻辑如下：
        1. 如果值和真实值在小容差下完全相同，则实现被认为是正确的。
        2. 如果没有提供真实值，如果代码执行成功且代码反馈与场景和模型描述对齐，则实现被认为是正确的。

        请按JSON格式回复评论。以下是JSON输出的示例结构，请严格遵循格式：
        {
            "final_decision": True,
            "final_feedback": "最终反馈消息",
        }
    user: |-
        --------------模型信息:---------------
        {{ model_information }}
        --------------模型执行反馈:---------------
        {{ model_execution_feedback }}
        --------------模型形状反馈:---------------
        {{ model_shape_feedback }}
        --------------模型代码反馈:---------------
        {{ model_code_feedback }}
        --------------模型值反馈:---------------
        {{ model_value_feedback }}
